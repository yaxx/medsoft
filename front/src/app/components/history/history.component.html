
<div  class="modal " role="dialog" tabindex="-1" id="scanFiles" style="background-color: rgba(0, 0, 0, .5);
max-width:100%;">
    <div data-dismiss="modal" style="height: 25px; width:25px; color: whitesmoke;background:rgba(0, 0, 0, 0.4)" class="close-comment">
        <i title="close" class="icon ion-ios-close-empty"></i>
    </div>
    <div style="max-width:100%;height: 100%; display: flex;justify-content: center;align-content: center;align-content: center;">
        <div style="height: 100%;width:563px;background-color: rgba(0, 0, 0, .5);overflow: hidden;position: relative;">
            <div *ngFor="let image of images; let i = index" class="image-container" [class.current-image]='currentImage === i'>
                <img style="height: 100%;width:100%;bottom:0px;top:0px" [src]=getDp(image)/>
            </div>
        </div>
    </div>
    <div style="left:12%; top:45%;position: absolute;width: 7%;" class="btn-group disposition">
        <button [disabled]='currentImage === 0' (click) = prevImage() style="width:32px;border:none;background:rgba(0, 0, 0, .2);height: 32px;border-radius: 50%;left:35%"   class="btn btn-outline-primary  dispo " >
            <i  style='position:absolute;right:36%;top:2px; font-size:large; cursor:pointer; display: inline-block;' title="Back" class="icon ion-android-arrow-back "> 
            </i>
        </button>
    </div>
    <div style="left: 81%; top:45%;position: absolute; width: 7%;" class="btn-group disposition">
        <button [disabled]='currentImage === images.length-1' (click)=nextImage() style="width:32px;border:none;background:rgba(0, 0, 0, 0.4); height: 32px;border-radius: 50%;left:35%"   class="btn btn-outline-primary  dispo " >
            <i   style='position:absolute;right:36%;top:2px; font-size:large; cursor:pointer; display: inline-block;' title="Next" class="icon ion-android-arrow-forward "> 
            </i>
        </button>
    </div>
</div>







<div  class="modal " role="dialog" tabindex="-1" id="consModal" style="border-radius:32px;max-width:841px;margin: auto;padding-top: 35px">
        <div style="max-width: 730px;border-radius:32px;" class="modal-dialog" role="document">
            <div class="modal-content" style="width:100%; height:400px;border-radius:32px;padding-left:0px;padding-right: 0px;">
                <div class="modal-body" style="border-radius:32px;padding: 0px;">
                    <div class="card card-secondary historycard midlecard profilecard" style="margin:auto;min-height:400px;border-radius:32px;width:100%;position: absolute">
                        <div data-dismiss="modal" style="height: 25px; width:25px; top:3%; cursor: pointer;  color: white(248, 248, 248); background:rgba(193, 193, 224, 0.2)" class="close-comment">
                            <i title="close" class="icon ion-ios-close-empty"></i>
                        </div>
                        <div style='padding-left: 30px;border-top-right-radius:32px;border-top-left-radius:32px;border-bottom: 0px;height:40px;margin-bottom: 30px;' class="card-header profileheader small-header">
                            <div style="left:23px;top:13px" class="timeline lastdoc priscriber headerdp small-dp">
                                <img [src]=getDp(patient.info.personal.avatar)/>
                            </div>
                            <p style="top:5px" class="patien-name small-name">
                              {{patient.info.personal.firstName + ' '+ patient.info.personal.lastName}}<span class="small-headericon"></span>
                            </p>
                            <h6 style='font-size:11px;position:absolute;color:dodgerblue; font-weight: normal; top:18px;left:75%' class="patien-name small-name">ENCOUNTER</h6>
                        </div>
                        <div class="card-body orderbody" style="width:85%;margin:auto;">
                            <div class="steps">
                                <div style="cursor: pointer;"  title="Go to" (click) = goTo(0) [class.curent-step] = 'count===0' class="step-item">
                                    <span>
                                        <h6 class="step-lebel">COMPLAIN</h6>
                                   </span>
                                    <span *ngIf="session.complains.length">
                                        <i  class="icon ion-ios-checkmark-empty paid-icon"></i>
                                   </span>
                                </div>
                                <div style="cursor: pointer;" title="Go to" (click) = goTo(1) [class.curent-step] = 'count===1' class="step-item">
                                    <span >
                                        <h6 class="step-lebel">HISTORY</h6>
                                    </span>
                                    <span *ngIf="session.famHist.condition||session.allegies.allegy">
                                        <i  class="icon ion-ios-checkmark-empty paid-icon"></i>
                                   </span>
                                </div>
                                
                                <div style="cursor: pointer;"  title="Go to" (click) = goTo(2)  [class.curent-step] = 'count === 2' class="step-item">
                                    <span >
                                        <h6 class="step-lebel">VITALS</h6>
                                    </span>
                                    <span *ngIf="session.vitals.bp.systolic&&session.vitals.bp.diastolic||session.vitals.tempreture.value||session.vitals.resp.value||session.vitals.pulse.value">
                                        <i  class="icon ion-ios-checkmark-empty paid-icon"></i>
                                    </span>
                                </div>
                                <div style="cursor: pointer;"  title="Go to" (click) = goTo(3) [class.curent-step] = 'count===3' class="step-item">
                                    <span>
                                        <h6 class="step-lebel">LAB</h6>
                                    </span>
                                    <span *ngIf='session.tests.length||session.scans.length||session.surgeries.length'>
                                        <i  class="icon ion-ios-checkmark-empty paid-icon"></i>
                                    </span>
                                </div>
                                <div style="cursor: pointer;"  title="Go to" (click) = goTo(4) [class.curent-step] = 'count===4' class="step-item">
                                    <span >
                                    <h6 class="step-lebel">DIAGNOSIS</h6>
                                    </span>
                                    <span *ngIf="session.conditions.length">
                                        <i  class="icon ion-ios-checkmark-empty paid-icon"></i>
                                    </span>
                                </div>
                                <div style="cursor: pointer;"  title="Go to" (click) = goTo(5) [class.curent-step] = 'count === 5' class="step-item">
                                    <span >
                                        <h6 class="step-lebel">MEDICATIONS</h6>
                                    </span>
                                    <span *ngIf="session.medications.length">
                                        <i  class="icon ion-ios-checkmark-empty paid-icon"></i>
                                    </span>
                                </div>
                                <div style="cursor: pointer;"  title="Go to" (click) = goTo(6) [class.curent-step] = 'count === 6' class="step-item">
                                    <span>
                                        <h6 class="step-lebel">NOTES</h6>
                                    </span>
                                    <span *ngIf="session.note.note">
                                        <i  class="icon ion-ios-checkmark-empty paid-icon"></i>
                                    </span>
                                </div>
                            </div>
                            <form *ngIf="count === 0"  style="top: 3%; height:100%;width:60%;position: relative;margin:auto;" class=" staffsform">
                                <div class="form-group vitals-section address" style='font-size:11px;resize:none;min-height: 26px'>
                                    <label style="font-size:8px" for="piriod" class="labelss complain">CHIEF COMPLAIN</label>
                                    <input [(ngModel)]="session.complain.complain" style=" font-size:11px;" name="piriod" class="form-control patientdata inputs dataInfo">
                                </div>
                                <div class="form-group vitals-section formGroup" style='width:94%;margin-bottom:2px'><span></span>
                                    <label style="font-size:8px" for="piriod" class="labelss complain">DURATION</label>
                                    <input name='numofDays' [(ngModel)]="session.complain.duration" style=" font-size:11px;border-top-right-radius: 0px;border-right:0px;width: 99%;border-bottom-right-radius: 0px;" type="number" [min]='1' name="piriod" class="form-control patientdata inputs dataInfo" placeholder='Number of days'>
                                    <div id='moreBtn' title="Add complain">
                                        <i *ngIf="session.complain.duration &&session.complain.complain"style="left: 13%;top: -21%;
                                        font-size: 23px;
                                        position: relative;
                                        cursor: pointer;" (click)="addComplain()" class="icon ion-ios-plus-empty arrow ">
                                        </i>
                                    </div>
                                </div>
                                <div *ngIf='session.complains.length' class="form-group vitals-section setGroup">
                                    <table cellspacing="0" class="data-table drugs-table" style="width:100%;left:0%;" summary="List of all items in store. ">
                                        <thead class='productHead'>
                                            <tr class="patient-th">
                                                <th style='padding:4px;font-size:10px;color: #6c757d;font-weight:bold' class="headlbl patient-th">COMPLAIN</th>
                                                <th style='padding: 4px;font-size:10px;text-align: right;color: #6c757d;font-weight:bold' class="headlbl patient-th">DURATION</th>
                                                <th style='padding: 4px;font-size:10px' class="headlbl patient-th"></th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr style="border-bottom: 1px solid #f8f9fa;"  *ngFor='let complain of session.complains; let i = index; let odd = odd' class="ro patient-row">
                                                <td style="padding:0px;padding-left:4px;" class="data">
                                                    {{complain.complain}}
                                                </td>
                                                <td style="padding:0px;text-align: right;padding-left:4px;" class="data">
                                                    {{complain.duration+'d'}}
                                                </td>
                                                <td style='padding:0px; padding-left:3px;text-align: center;color:darkgray' class="data">
                                                    <i (click)=removeComplain(i) class="icon ion-ios-trash-outline tableicon" title="Discard" style="font-size:15px; cursor: pointer;"></i>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </form>
                            <form *ngIf="count===1"  style="top:3%;height:100%;width:60%;position:relative;margin:auto;" class=" staffsform">
                                <div class="form-group vitals-section" style="width:100%; margin-right: 5px; display:inline-block">
                                    <label style="font-size:8px" for="famhistory" class="labelss">
                                        FAMILY HISTORY
                                    </label>
                                    <input [(ngModel)]="session.famHist.condition"  name="famhistory" class=" form-control patientdata dystolic inputs dataInfo"/>
                                    <div style="min-height:400px;" *ngIf='checkItems("history")' class="options prisOption edit">
                                    </div>
                                </div>
                                <div style="width:100%; display:inline-block" class="form-group vitals-section">
                                    <label style="font-size:8px" for="allegy" class="labelss">ALLEGIES<span style='font-size:11px; color:red;'>*</span> </label>
                                    <input  [(ngModel)]="session.allegies.allegy" name="allegy" class="form-control patientdata dystolic inputs dataInfo" />
                                </div>
                            </form>
                            <form *ngIf="count===3"  style="top: 3%; height: 100%;width:60%;margin:auto;position: relative;" class=" ">
                                <div class="form-group vitals-section address">
                                    <label style="font-size:8px" for="request" class="labelss">REQ. TYPE</label>
                                    <select (focus) = clearMsg()  (change)=getDescriptions() name='cat' [(ngModel)]="session.reqItem.category" autocomplete="off" class="patientdata dystolic inputs dataInfo">
                                        <option>Scanning</option>
                                        <option>Surgery</option>
                                        <option>Test</option>
                                    </select>
                                </div>
                                <div *ngIf="session.reqItem.category==='Test'"  class="form-group vitals-section formGroup" style=" width:47%;margin-right: 5px;">
                                    <label style="font-size:8px" for="dos" class="labelss complain">TEST</label>
                                    <input autocomplete="off" [(ngModel)]="session.test.name" (keyup) = searchTest() name="test" class="form-control patientdata inputs dataInfo" placeholder="Alpha-feto protein PB">
                                    <div  *ngIf="matches.length" style="position: absolute;z-index:200;height: 300px;border: none;"  class="options prisOption edit">
                                        <ul data-simplebar class="itemsList" style=" border-radius:4px; height: 300px;background-color: white;border:1px solid whitesmoke">
                                            <li *ngFor="let match of matches">
                                                <p (click)=selectTest(match) class="dept firstheader drugItem" style="font-size:11px;padding-left: 10px; padding-right: 10px;font-weight: normal;">{{match}}<span class="lastdept timetaken "></span>
                                                </p>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div *ngIf="session.reqItem.category==='Test'" class="form-group vitals-section formGroup" style=" width:44%;">
                                    <label style="font-size:8px" for="piriod" class="labelss complain">DEPARTMENT</label>
                                    <select [(ngModel)]="session.test.dept" (focus) = clearMsg() style='border-top-right-radius: 0px;border-bottom-right-radius: 0px;border-right: 0px;    width: 99%;' name='dept'  autocomplete="off" class="patientdata dystolic inputs dataInfo">
                                        <option *ngFor="let dept of getLabs()">{{dept.name}}</option>
                                    </select>
                                    <div id='moreBtn'>
                                        <i *ngIf="session.test.name && session.test.dept" title = "Add Request" style="left: 13%;top: -21%;
                                        font-size: 23px;
                                        position: relative;
                                        cursor: pointer;" (click)="addRequest()" class="icon ion-ios-plus-empty arrow "></i>
                                    </div>
                                </div>
                                <div *ngIf="session.reqItem.category==='Scanning'"  class="form-group vitals-section formGroup" style=" width:47%;margin-right: 5px;">
                                    <label style="font-size:8px" for="dos" class="labelss complain">SCAN</label>
                                    <input [(ngModel)]="session.scan.name" (keyup) = searchScans()  name="scan" class="form-control patientdata inputs dataInfo" placeholder="e.g Chest X-ray">
                                    <div  *ngIf="matches.length" style="position: absolute;z-index:200;height: 300px;border: none;"  class="options prisOption edit">
                                        <ul data-simplebar class="itemsList" style=" border-radius:4px; height: 300px;background-color: white;border:1px solid whitesmoke">
                                            <li *ngFor="let match of matches">
                                                <p (click)=selectScan(match) class="dept firstheader drugItem" style="font-size:11px;padding-left: 10px; padding-right: 10px;font-weight: normal;">{{match}}<span class="lastdept timetaken "></span>
                                                </p>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div *ngIf="session.reqItem.category==='Scanning'" class="form-group vitals-section formGroup" style=" width:44%;">
                                    <label style="font-size:8px" for="piriod" class="labelss complain">DEPARTMENT</label>
                                    <select [(ngModel)]="session.scan.dept" (focus) = clearMsg() style='border-top-right-radius: 0px;border-bottom-right-radius: 0px;border-right: 0px;    width: 99%;' name='dept'  autocomplete="off" class="patientdata dystolic inputs dataInfo">
                                        <option *ngFor="let dept of getLabs()">{{dept.name}}</option>
                                    </select>
                                    <div id='moreBtn'>
                                        <i *ngIf="session.scan.name && session.scan.dept" title = "Add Request" style="left: 13%;top: -21%;
                                        font-size: 23px;
                                        position: relative;
                                        cursor: pointer;" (click)="addRequest()" class="icon ion-ios-plus-empty arrow "></i>
                                    </div>
                                </div>


                                <div *ngIf='session.tests.length||session.scans.length' class="form-group vitals-section setGroup">
                                    <table cellspacing="0" class="data-table drugs-table" style="width:100%;left:0%;" summary="List of all items in store. ">
                                        <thead class='productHead'>
                                            <tr class="patient-th">
                                                <th style='padding: 4px;font-size:10px;color: #6c757d;font-weight:bold' class="headlbl patient-th">REQUEST</th>
                                                <th style='padding: 4px;font-size:10px;text-align: right; color: #6c757d;font-weight:bold' class="headlbl patient-th">PRICE</th>
                                                <th style='padding: 4px;font-size:10px;color: #6c757d;' class="headlbl patient-th"></th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr style="border-bottom: 1px solid #f8f9fa;" *ngFor='let item of session.invoices; let i = index; let odd = odd' class="ro patient-row">
                                                <td style="padding:0px;padding-left:4px;" class="data">
                                                    {{item.name}}
                                                </td>
                                                <td style="padding:0px;text-align: right;padding-left:4px;" class="data">
                                                    {{item.price||'---'}} </td>
                                                <td style='padding:0px; padding-left:3px;text-align: center' class="data">
                                                    <i (click)=removeRequest(i,item) class="icon ion-ios-trash-outline tableicon" title="Discard" style="font-size:15px; cursor: pointer;"></i>
                                                </td>
                                            </tr>
                                        </tbody>
                                        <tfoot col-span='4' style='font-size:11px; text-align:right; position:absolute; color:lightgrey; font-weight:bold;padding-right: 15px; border-top: 1px solid whitesmoke;width:100%'>Total:&nbsp;<span style="color: black">{{getRequestTotal()}}</span> </tfoot>
                                    </table>
                                </div>
                            </form>
    
                            <form *ngIf="count === 2"  style="top: 3%; height: 100%;width:60%;margin:auto;position: relative;" class=" ">
                                <div class="form-group vitals-section address">
                                    <label style="font-size:8px" for="request" class="labelss">VITAL</label>
                                    <select name="vital" [(ngModel)] = vital autocomplete="off" class="patientdata dystolic inputs dataInfo">
                                        <option>Blood Presure</option>
                                        <option>Tempreture</option>
                                        <option>Pulse Rate</option>
                                        <option>Respiratory Rate</option>
                                    </select>
                                </div>
                                <div *ngIf="vital==='Blood Presure'"  class="form-group vitals-section formGroup" style=" width:47%;margin-right: 5px;">
                                    <label style="font-size:8px" for="dos" class="labelss complain">SYSTOLIC</label>
                                    <input (keyup)="clearVital('Blood Presure')" [(ngModel)]="session.vitals.bp.systolic"  placeholder="mm Hg"   [min]='1' type="number" name="systolic" class="form-control patientdata inputs dataInfo">
                                </div>
                                <div *ngIf="vital==='Blood Presure'" class="form-group vitals-section formGroup" style=" width:44%;">
                                        <label style="font-size:8px" for="piriod" class="labelss complain">DIASTOLIC</label>
                                        <input style="border-right: none;" (keyup)="clearVital('Blood Presure')" [(ngModel)]="session.vitals.bp.diastolic" type="number" [min]='1' name="dystolic" class="form-control patientdata inputs dataInfo" placeholder="mm Hg">
                                        <div id='moreBtn'>
                                            <i style="left: 13%;top: -21%;
                                            font-size: 23px;
                                            position: relative;
                                            cursor: pointer;" (click)="addVital()" class="icon ion-ios-plus-empty arrow "></i>
                                        </div>
                                </div>
                                <div *ngIf="vital === 'Tempreture'" style="width: 93%;"  class="form-group vitals-section formGroup">
                                        <label style="font-size:8px" for="piriod" class="labelss complain">TEMPRETURE</label>
                                        <input style="border-right: none;" (keyup)="clearVital('Tempreture')"  [(ngModel)]="session.vitals.tempreture.value" type="number" [min]='1' name="temp" class="form-control patientdata inputs dataInfo" placeholder="Degree Fahrenheit">
                                        <div id='moreBtn'>
                                            <i style="left: 13%;top: -21%;
                                            font-size: 23px;
                                            position: relative;
                                            cursor: pointer;" (click)="addVital()" class="icon ion-ios-plus-empty arrow "></i>
                                        </div>
                                </div>
                                <div *ngIf="vital === 'Pulse Rate'" style="width: 93%;"  class="form-group vitals-section formGroup">
                                        <label style="font-size:8px" for="piriod" class="labelss complain">PULSE RATE</label>
                                        <input style="border-right: none;" (keyup)="clearVital('Pulse Rate')"  [(ngModel)]="session.vitals.pulse.value" type="number" [min]='1' name="pulse" class="form-control patientdata inputs dataInfo" placeholder="bpm">
                                        <div id='moreBtn'>
                                            <i style="left: 13%;top: -21%;
                                            font-size: 23px;
                                            position: relative;
                                            cursor: pointer;" (click)="addVital()" class="icon ion-ios-plus-empty arrow "></i>
                                        </div>
                                </div>
                                <div *ngIf="vital === 'Respiratory Rate'" style="width: 93%;"  class="form-group vitals-section formGroup">
                                        <label style="font-size:8px" for="piriod" class="labelss complain">RESPIRATORY RATE</label>
                                        <input style="border-top-right-radius: none;border-bottom-right-radius: none;" (keyup)="clearVital('Respiratory Rate')"  [(ngModel)]="session.vitals.resp.value" type="number" [min]='1' name="resp" class="form-control patientdata inputs dataInfo" placeholder="bpm">
                                        <div id='moreBtn'>
                                            <i style="left: 13%;top: -21%;
                                            font-size: 23px;
                                            position: relative;
                                            cursor: pointer;" (click)= addVital() class="icon ion-ios-plus-empty arrow "></i>
                                        </div>
                                </div>
                                <div *ngIf='vitals.length' class="form-group vitals-section setGroup">
                                        <table cellspacing="0" class="data-table drugs-table" style="width:100%;left:0%;" summary="List of all items in store. ">
                                            <thead class='productHead'>
                                                <tr class="patient-th">
                                                    <th style='padding: 4px;font-size:10px;color: #6c757d;font-weight:bold' class="headlbl patient-th">VITAL SIGN</th>
                                                    <th style='padding: 4px;font-size:10px;text-align: right; color: #6c757d;font-weight:bold' class="headlbl patient-th">VALUE</th>
                                                    <th style='padding: 4px;font-size:10px;color: #6c757d;' class="headlbl patient-th"></th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr style="border-bottom: 1px solid #f8f9fa;" *ngFor='let sign of vitals; let i = index; let odd = odd' class="ro patient-row">
                                                    <td style="padding:0px;padding-left:4px;" class="data">
                                                        {{sign.name}}
                                                    </td>
                                                    <td style="padding:0px;text-align: right;padding-left:4px;" class="data">
                                                        {{sign.val}} </td>
                                                    <td style='padding:0px; padding-left:3px;text-align: center' class="data">
                                                        <i (click)=removeVital(i,sign) class="icon ion-ios-trash-outline tableicon" title="Discard" style="font-size:15px; cursor: pointer;"></i>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                            </form>
                            <form *ngIf="count === 4"  style="top: 3%; height: 100%;width:60%;margin:auto;position: relative;" class=" ">
                                <div class="form-group vitals-section address" style='width:94%'>
                                    <label style="font-size:8px" for="request" class="labelss">CONDITION</label>
                                    <input autocomplete="off" [(ngModel)]="session.condition.condition" (keyup) = searchCond() name="test" class="form-control patientdata inputs dataInfo" placeholder="Diabetes mellitus">
                                    <div  *ngIf="matches.length" style="position: absolute;z-index:200;height: 300px;border: none;"  class="options prisOption edit">
                                        <ul data-simplebar class="itemsList" style=" border-radius:4px; height: 300px;background-color: white;border:1px solid whitesmoke">
                                            <li *ngFor="let match of matches">
                                                <p (click)=selectCond(match) class="dept firstheader drugItem" style="font-size:11px;padding-left: 10px; padding-right: 10px;font-weight: normal;">{{match}}<span class="lastdept timetaken "></span>
                                                </p>
                                            </li>
                                        </ul>
                                    </div>
                                    <div  id='moreBtn' >
                                        <i *ngIf="session.condition.condition" style="left: 13%;top: -21%;
                                        font-size: 23px;
                                        position: relative;
                                        cursor: pointer;"  
                                        (click) = "addCondition()" title="Add condition" class="icon   ion-ios-plus-empty arrow "></i>
                                    </div>
                                </div>
                                <div *ngIf='session.conditions.length' class="form-group vitals-section setGroup">
                                    <table cellspacing="0" class="data-table drugs-table" style="width:100%;left:0%;" summary="List of all items in store. ">
                                        <thead class='productHead'>
                                            <tr class="patient-th">
                                                <th style='padding: 4px;font-size:10px;color: #6c757d;font-weight:bold' class="headlbl patient-th">CONDITION</th>
                                                <th style='padding: 4px;font-size:10px;color: #6c757d;' class="headlbl patient-th"></th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr style="border-bottom: 1px solid #f8f9fa;" *ngFor='let cond of session.conditions; let i = index; let odd = odd' class="ro patient-row">
                                                <td style="padding:0px;padding-left:4px;" class="data">
                                                    {{cond.condition}}
                                                </td>
                                                <td style='padding:0px; padding-left:3px;text-align: center' class="data">
                                                    <i (click)=removeCondition(i) class="icon ion-ios-trash-outline tableicon" title="Discard" style="font-size:15px; cursor: pointer;"></i>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </form>
                            <form *ngIf="count===5"  style="top: 3%; width:60%;margin:auto;position: relative;" class=" ">
                                <div class="form-group vitals-section address">
                                    <label style="font-size:8px" for="drug" class="labelss">PRODUCT</label>
                                    <input (focus)=clearMsg() (keyup)= searchMedications() [(ngModel)]=session.medication.name placeholder="E.g paracetamol 500mg" style='font-size:11px;text-align:center;' autocomplete="off" type="text" name="drug" class="form-control patientdata dystolic inputs dataInfo"
                                    />
                                    <div  *ngIf="matches.length" style="position: absolute;z-index:200;height: 300px;border: none;"  class="options prisOption edit">
                                        <ul data-simplebar class="itemsList" style=" border-radius:4px; height: 300px;background-color: white;border:1px solid whitesmoke">
                                            <li *ngFor="let match of matches">
                                                <p (click)=selectMedic(match) class="dept firstheader drugItem" style="font-size:11px;padding-left: 10px; padding-right: 10px;font-weight: normal;">{{match}}<span class="lastdept timetaken "></span>
                                                </p>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="form-group vitals-section formGroup" style=" width:26%;">
                                    <label style="font-size:8px" for="dos" class="labelss complain">INTAE</label>
                                    <input [(ngModel)]="session.medication.priscription.intake" style="border-top-right-radius: 0px;border-bottom-right-radius: 0px;height:27px;text-align:center;font-size:11px" [min]='1' type="number" name="dos" class="patientdata inputs dataInfo">
                                </div>
                                <div class="form-group vitals-section formGroup" style=" width:39%; ">
                                    <label style="font-size:8px" for="freq" class="labelss complain">FREQ</label>
                                    <select (focus) = clearMsg()  [(ngModel)]="session.medication.priscription.freq" style="border-radius: 0px;font-size:11px; border-left: 0px;width: 100%; text-align:center; border-right:none;border: 1px solid whitesmoke; outline: none; border-bottom-right-radius:0px" class=" patientdata statusinputs dataInfo " name="freq">
                                        <option>bd</option>
                                        <option>od</option>
                                        <option>qds</option>
                                        <option>tds</option>
                                    </select>
                                </div>
                                <div class="form-group vitals-section formGroup" style=" width:28%;">
                                    <label style="font-size:8px" for="piriod" class="labelss complain">DAYS</label>
                                    <input (focus)=clearMsg()  name='days' [(ngModel)]="session.medication.priscription.piriod" style="border-radius: 0px;border-right:0px;text-align:center;height:27px;" type="number" [min]='1' name="piriod" class="patientdata inputs dataInfo">
                                    <div id='moreBtn'>
                                        <i *ngIf="session.medication.name && session.medication.priscription.intake &&session.medication.priscription.freq &&session.medication.priscription.piriod" style="left: 13%;top: -21%;
                                        font-size: 23px;
                                        position: relative;
                                        cursor: pointer;" title="Add Medication" (click)="addMedication()" class="icon ion-ios-plus-empty arrow ">
                                        </i>
                                    </div>
                                </div>
                                <div *ngIf="session.medications.length" class="form-group vitals-section setGroup">
                                    <table cellspacing="0" class="data-table drugs-table" style="width:100%;left:0%;" summary="List of all items in store. ">
                                        <thead class='productHead'>
                                            <tr class="patient-th">
                                                <th style='padding: 4px;font-size:10px;font-weight:bold;color:darkgray' class="headlbl patient-th">PRODUCT</th>
                                                <th style='padding: 4px;font-weight:bold;font-size:10px;color:darkgray' class="headlbl patient-th">DOSAGE</th>
                                                <th style='padding: 4px;font-weight:bold;text-align:right;font-size:10px;color:darkgray' class="headlbl patient-th">PRICE</th>
                                                <th style='padding: 2px;' class="headlbl patient-th"></th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr style="border-bottom: 1px solid #f8f9fa;"  *ngFor="let med of session.medInvoices let i = index; let odd = odd;" class="ro patient-row">
                                                <td style="padding:0px;padding-left:4px;" class="data">{{med.name}}</td>
                                                <td style='padding:0px;' class="data">
                                                    {{getPriscription(med)}}</td>
                                                <td style='padding:0px;text-align:center;padding:0px' class="data" >
                                                    {{med.price||'---'}}
                                                </td>
                                                <td style="text-align:left;padding:0px; padding-left:3px" class="data">
                                                    <i (click)="removePriscription(i)" class="icon ion-ios-trash-outline tableicon" title="Discard" style="font-size:15px; cursor: pointer;"></i>
                                                </td>
                                            </tr>
                                        </tbody>
                                        <tfoot col-span='4' style='font-size:11px; text-align:right; position:absolute; color:lightgrey; font-weight:bold;padding-right: 15px; border-top: 1px solid whitesmoke;width:100%'>Total:&nbsp;<span style="color: black">{{getPriceTotal()}}</span> </tfoot>
                                     
                                    </table>
                                </div>
                            </form>
                            <form *ngIf="count===6"  style="top: 3%; width:60%;margin:auto;position: relative; border-bottom: 1px solid whitesmoke" class=" ">
                                <div class="form-group vitals-section formGroup newnote">
                                    <textarea [(ngModel)]="session.note.note" id='newnote' style="width:100%; min-height: 150px; font-size: 13px; padding: 5px; border: 0px; " name="note" placeholder="Additional note"></textarea>
                                </div>
                            </form>
                        </div>
                        <div style="left:12%; top:45%;position: absolute;
                        width: 7%;" class="btn-group disposition">
                            <button [disabled]='count === 0' (click) = prev() style="width:32px;height: 32px;border-radius: 50%;left:35%"   class="btn btn-outline-primary  dispo shift-button" >
                                <i  style='position:absolute;right:36%;top:2px; font-size:large; cursor:pointer; display: inline-block;' title="Back" class="icon ion-android-arrow-back "> 
                                </i>
                            </button>
                        </div>
                        <div style="left: 76%; top:45%;position: absolute;
                        width: 7%;" class="btn-group disposition">
                            <button [disabled]='count === 6'(click)=next() style="width:32px;height: 32px;border-radius: 50%;left:35%"   class="btn btn-outline-primary  dispo shift-button" >
                                <i   style='position:absolute;right:36%;top:2px; font-size:large; cursor:pointer; display: inline-block;' title="Next" class="icon ion-android-arrow-forward "> 
                                </i>
                            </button>
                        </div>
                        <div *ngIf="count === 6" style="left:31%;top:-74px;position:relative;width:53%" class="btn-group disposition">
                            <button [disabled]='isEmptySession()' 
                            (click) = updateRecord() style=" width:170px;font-size: 10px; border-radius: 30px; height:27px;left:15%; bottom:10%;" class="btn btn-sm btn-outline-primary mainbtn">
                            <span>
                                <i *ngIf="processing"  class="fa fa-circle-o-notch fa-spin fa-10x slow-spin" style="position:absolute;bottom:2px;left:14px;font-size:20px;color: #1da1f2;">
                                </i>
                            </span>
                                UPDATE RECORD
                            </button>
                        </div>
                        <h6 *ngIf="feedback" class="feedbackMsg">{{feedback}}</h6>
                        <h6 *ngIf="errLine"  style="color: red" class="feedbackMsg">{{errLine}}</h6>
                    </div>
                </div>
            </div>
        </div>
    </div>






    
<div style="padding-top:0px" class="container history-container">
    <div class="row history-row">
        <div *ngIf='!patient._id' class='issue'>
            <div *ngIf='loading' class="lds-css ng-scope">
            <div style="width:100%;height:100%" class="lds-rolling"><div></div></div></div>
            <div (click) = refresh()  *ngIf='message' title='Refresh' class='refresh'><i class="icon ion-ios-reload "></i></div>
             <h6 *ngIf='message' style='font-size:13px;position:absolute;top:65%; width:100%; color:lightgrey;text-align: center' >{{message}}</h6>
         </div>
        <div *ngIf='patient._id' class="col col-xs-3 col-sm-3 col-md-3 col-lg-3 col-xl-3">
            <div class="card-colums leftcolumn">
                <div class="card card-secondary historycard leftcard">
                    <div class="card-body infobody">
                        <div class="carditem">
                            <div class="timeline detailstimeline"><i class="icon ion-ios-person-outline deticon"></i></div>
                            <h6 class="dept detailshead">PERSONAL INFO</h6>
                            <p class="dept previnfo">Age:&nbsp;<span class="predata">
                              {{patient.info.personal.dob|dob}}</span></p>
                            <p class="dept previnfo">Gender:&nbsp;<span class="predata">
                              {{patient.info.personal.gender||'---'}}</span></p>
                            <p class="dept previnfo">Marital Status:&nbsp;<span class="predata">
                              {{patient.info.personal.mstatus||'---'}}</span></p>
                            <p class="dept previnfo">Occupation:&nbsp;<span class="predata">
                              {{patient.info.personal.occupation||'---'}}</span></p>
                            <p class="dept previnfo">Religion:&nbsp;<span class="predata">
                              {{patient.info.personal.religion||'---'}}</span></p>
                            <p class="dept previnfo">Tribe:&nbsp;<span class="predata">
                              {{patient.info.personal.tribe||'---'}}</span></p>
                            <p *ngIf="patient.record.cards.length" class="dept previnfo">Card Type:&nbsp;<span class="predata">
                              {{patient.record.cards[0].category||'---'}}</span></p>
                            <p *ngIf="patient.record.cards.length" class="dept previnfo">Card No:&nbsp;<span class="predata">
                                {{patient.record.cards[0].pin||'---'}}</span>
                            </p>
                        </div>
                        <div class="carditem">
                            <div class="timeline detailstimeline"><i class="icon ion-ios-location-outline deticon"></i></div>
                            <h6 class="dept detailshead">CONTACT</h6>
                            <p class="dept previnfo">Mobile:&nbsp;<span class="predata">
                              {{patient.info.contact.me.mobile||'---'}}</span></p>
                            <p class="dept previnfo">Email:&nbsp;<span class="predata">
                              {{patient.info.contact.me.email||'---'}}</span></p>
                            <p class="dept previnfo">Address:&nbsp;<span class="predata">
                              {{patient.info.contact.me.address||'---'}}</span></p>
                            <p class="dept previnfo">State:&nbsp;<span class="predata">
                              {{patient.info.contact.me.state||'---'}}</span></p>
                            <p class="dept previnfo">City:&nbsp;<span class="predata">
                              {{patient.info.contact.me.lga||'---'}}</span></p>
                            <p class="dept previnfo">Next of Kin:&nbsp;<span class="predata">
                              {{patient.info.contact.me.kinName||'---'}}</span></p>
                            <p class="dept previnfo">Emergency:&nbsp;<span class="predata">
                              {{patient.info.contact.emergency.mobile||'---'}}</span></p>
                        </div>
                        <div class="carditem">
                            <div class="timeline detailstimeline"><i style="position:absolute; color:lightblue;left:6px" class="icon ion-ios-lightbulb-outline deticon"></i></div>
                            <h6 class="dept detailshead">INSURANCE</h6>
                            <p class="dept previnfo">ID&nbsp;<span class="predata">
                                {{patient.info.insurance.groupNo||'---'}}</span></p>
                            <p class="dept previnfo">Employer:&nbsp;<span class="predata">
                                {{patient.info.insurance.employer||'---'}}</span></p>
                            <p class="dept previnfo">HMO:&nbsp;
                            <span class="predata">{{patient.info.insurance.employer||'---'}}</span></p>
                            <p class="dept previnfo">SSN:&nbsp;<span class="predata">
                                {{patient.info.insurance.ssn||'08QA89'}}</span></p>
                        </div>
                    </div>
                </div>
                
                <div class="card card-secondary historycard leftcard visits">
                    <div class="card-header grapheader">
                        <h1 class="dept headtitle">VISITS</h1>
                    </div>
                    <div style ="padding-left:17px;" class="card-body rightcardbody">
                        <div  *ngFor="let visit of patient.record.visits; let i = index"  class="carditem priscriptioncontainer order">
                            <div style='left:-7.2%' class="timeline condition drugtimeline">
                                <p class="timelinedate"> {{visit[0]?.visitedOn|date:'dd'}}</p>
                                <p  class="timelinedate month"> {{visit[0]?.visitedOn|date:'MMM'|uppercase}}</p>
                            </div>
                            <div *ngFor ="let vst of visit; let j= index" class="priscription drug">
                                <p class="dept">{{vst.dept}}
                                    <span style="left: 72%;" class="predata notetime">{{vst.visitedOn|date:'hh:mma'|lowercase}}</span>
                                    <!-- <span style="top: 100%;left: 1%;position: absolute;" class="predata">
                                        {{vst.dischargedOn|date:'dd-MM-y hh:mma'|lowercase}}
                                    </span> -->
                                </p>
                                
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card card-secondary historycard leftcard deathinfo">
                    <div class="card-header grapheader">
                        <h1 class="dept headtitle">ALLEGIES</h1>
                    </div>
                    <div class="card-body rightcardbody">
                        <h1 *ngIf='!patient.record.allegies.length' style='color:lightgrey; ' class="dept headtitle record-placeholder">NO RECORD</h1>
                      <h1 *ngIf='!patient.record.allegies.length' style='color:lightgrey; width:100%; text-align:center;top:43%;position:absolute;' class="dept headtitle">NO RECORD</h1>
                        <div class="carditem">
                            <ul class="itemlist">
                                <li *ngFor = 'let a of patient.record.allegies'>
                                    {{a.allegy}}
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="card card-secondary historycard leftcard deathinfo">
                    <div class="card-header grapheader">
                        <h1 class="dept headtitle">DEATH INFORMATION</h1>
                    </div>
                    <div class="card-body rightcardbody">
                        <h1 style='color:lightgrey; width:100%; text-align:center;top:43%;position:absolute;' class="dept headtitle">NO RECORD</h1>
                        <div class="carditem"></div>
                    </div>
                </div>
            </div>
        </div>
        <div *ngIf='patient._id' class="col col-xs-6 col-sm-6 col-md-6 col-lg-6 col-xl-6">
            <div class="card-colums">
                <div class="card card-secondary historycard midlecard graphcard">
                    <div style="margin-left: 0px; border:0px" class="card-body notecardbody nopading">
                        <p class="date-created">{{patient.createdAt|date:'dd MMM, yy'}}&nbsp;
                            <span>{{patient.createdAt|date:'hh:mma'|lowercase}}</span>
                        </p>
                        <div style="position: relative;height:90px;width:90px;left:-2px;margin:auto;border-radius: 50%" class="timeline noter patientdp">
                            <img style='height:100%; width:100%; object-fit:cover; border-radius:50%;' [src] = getDp(patient.info.personal.avatar)/>
                        </div>
                            <h1 style="padding:0px; text-align:center;margin: auto; position: relative; width:350px; font-size:18px;" class="dept previnfo noterinfo patientname">
                            {{patient.info.personal.firstName + ' ' + patient.info.personal.lastName}}
                        </h1>
                        <div *ngIf="!edit" class="profile">
                            <div class="items figures">
                                <span>
                                    <h6 *ngIf="patient.record.vitals.bloodGl.length" style="color: darkgray; font-size: 13px; font-weight: bold;top:5px" class="label-val">
                                        {{patient.record.vitals.bloodGl[0].value}}
                                    </h6>
                                    <h6 *ngIf="!patient.record.vitals.bloodGl.length" style="color: darkgray; font-size: 13px; font-weight: bold;top:5px" class="label-val">
                                        ---
                                    </h6>
                                </span>
                                <span><h6 class="lebels">BLOOD</h6></span>
                            </div>
                                <div class="items figures">
                                    <span >
                                        <h6 *ngIf="patient.record.vitals.height.length" style="color: darkgray; font-size: 13px; font-weight: bold; top:5px" class="label-val">
                                            {{patient.record.vitals.height[0].value}}<span  style="font-size: 10px;" class="units">ft</span>
                                        </h6>
                                        <h6 *ngIf="!patient.record.vitals.height.length" style="color: darkgray; font-size: 13px; font-weight: bold; top:5px" class="label-val">
                                         ---
                                        </h6>
                                    </span>
                                    <span><h6 class="lebels">HEIGHT</h6></span>
                                </div>
                                <div class="items figures">
                                    <span>
                                        <h6 *ngIf="patient.record.vitals.weight.length"  style="color: darkgray; font-size: 13px; font-weight: bold;top:5px;width: 39px;" class="label-val">
                                            {{patient.record.vitals.weight[0].value}}
                                            <span style="font-size: 10px;" class="units">kg</span>
                                        </h6>
                                        <h6 *ngIf="!patient.record.vitals.weight.length"   style="color: darkgray; font-size: 13px; font-weight: bold;top:5px; width: 39px;" class="label-val">
                                            ---
                                        </h6>
                                    </span>
                                    <span ><h6 class="lebels">WEIGHT</h6> </span>
                                
                                </div>
                                <i *ngIf=!edit (click)= showEdit() title="Edit" class="material-icons edit-profile">edit</i>
                            </div>
                            <div *ngIf="edit" style="position: absolute;  top: 60%; left: 126px;" class="profile">
                                <form  style="top: 6%; margin:auto;position: absolute;" class=" ">
                                    <div class="form-group vitals-section formGroup" style=" width:26%;">
                                        <label style="font-size:8px" for="dos" class="labelss complain">BLOOD</label>
                                        <input [(ngModel)]="session.vitals.bloodGl.value" style="border-top-right-radius: 0px;border-bottom-right-radius: 0px;text-align:center;font-size:11px" name="bg" class="patientdata inputs dataInfo">
                                    </div>
                                    <div class="form-group vitals-section formGroup" style=" width:39%; ">
                                        <label style="font-size:8px" for="freq" class="labelss complain">HEIGHT</label>
                                        <input type="number" (focus) = clearMsg()  [(ngModel)]="session.vitals.height.value" style="border-radius: 0px;font-size:11px; border-left: 0px;width: 100%; text-align:center; border-right:none;border: 1px solid whitesmoke; outline: none; border-bottom-right-radius:0px" class=" patientdata statusinputs dataInfo " name="freq">
                                    </div>
                                    <div class="form-group vitals-section formGroup" style=" width:28%;">
                                        <label style="font-size:8px" for="weight" class="labelss complain">WEIGHT</label>
                                        <input (focus)=clearMsg()  name='weight'  [(ngModel)]="session.vitals.weight.value"  style="border-radius: 0px;border-right:0px;text-align:center;" type="number" [min]='1' name="piriod" class="patientdata inputs dataInfo">
                                        <div style="height: 26px;top: 1px;" id='moreBtn'>
                                            <i *ngIf="editing ==='editing'" class="fa fa-circle-o-notch fa-spin fa-10x slow-spin" style="position:absolute;bottom:4px;left:3px;font-size:16px;color: #1da1f2;">
                                            </i>
                                            <i *ngIf="editing==='edited'" class="icon ion-ios-checkmark-empty paid-icon"></i>
                                            <i *ngIf=!editing style="left: 13%;top: -21%;font-size: 23px; position: relative;
                                            cursor: pointer;" title="Update" (click)="addProfiles()" class="icon ion-ios-plus-empty arrow ">
                                            </i>
                                        </div>
                                    </div>
                                </form>
                                <i *ngIf="edit" (click)= hideEdidt() style="left: 108%; position: absolute; top: -7px;" title="close" class="icon ion-ios-close-empty close-comment"></i>
                            </div>
                            <div style="width:150px;margin:auto;top:70%;left: 33%;position: absolute;">
                                <button *ngIf="isConsult() && (patient.record.visits[0][0].status ==='queued'|| patient.record.visits[0][0].status === 'Admit') " data-toggle="modal" data-target="#consModal"   style=" width:150px;top:16px;margin:auto;font-size:10px; height:27px;position:relative;left: 4px;" class="btn btn-sm btn-outline-primary  mainbtn">
                                    ENCOUNTER
                                </button>
                            </div>
                    </div>
                </div>
                <div style="margin-bottom: 3px" class="card card-secondary historycard midlecard graphcard">
                    <div style='border-top-right-radius:12px;border-top-left-radius:12px;' class="card-header grapheader">
                        <h1 class="dept headtitle">NOTES</h1>
                    </div>
                    <div class="card-body notecardbody">
                        <h1 *ngIf='!patient.record.notes.length' style='color:lightgrey; ' class="dept headtitle record-placeholder">NO NOTES</h1>
                        <div *ngFor = "let note of patient.record.notes;let i=index" class="carditem noteitem writeup">
                          <div style="position:absolute;left:-3%;" class="timeline lastdoc priscriber headerdp small-dp">
                            <img [src] = getDp(note.meta.addedBy.info.personal.avatar)/>
                          </div>
                            <h1 class="dept previnfo noterinfo">
                                {{note.meta.addedBy.info.personal.firstName+' '+note.meta.addedBy.info.personal.lastName}}
                              <span style='color: lightgray;font-weight: normal' >
                                {{'|'+' '+ note.meta.addedBy.info.official.department}}</span>
                              <span class="predata notetime">
                                {{note.meta.dateAdded|date:'dd/MM/y hh:mma'|lowercase}}</span>
                            </h1>
                            <p class="note-item">{{note.note}}<br>
                              <!-- <span *ngIf= "!compareNotes(i, note)" (click) = "readMore($event,i)" class="read-more"><a href="#">Read more</a></span> -->
                          </p>
                        </div>
                    </div>
                    <p class="card-link view-more">Show more<span><i class="icon ion-android-more-vertical thread-icon"></i></span>
                    </p>
                </div>
                <div class="card-group">
                    <div style='border-radius:12px;margin-bottom: 4px;' class="card card-secondary maincard halfcard">
                        <div style='border-top-right-radius:12px;border-top-left-radius:12px'  class="card-header grapheader">
                            <h1 class="dept headtitle">TESTS</h1>
                        </div>
                        <div style='height:100%;padding-left: 17px;' class="card-body midcardbody">
                            <h1 *ngIf="!patient.record.tests" style='color:lightgrey; ' class="dept headtitle record-placeholder">NO RECORD</h1>
                            <div  *ngFor="let tetst of patient.record.tests; let i = index"  class="carditem priscriptioncontainer order">
                                <div style='left:-7.2%' class="timeline condition drugtimeline">
                                    <p class="timelinedate"> {{tetst[0]?.meta.dateAdded|date:'dd'}}</p>
                                    <p  class="timelinedate month"> {{tetst[0]?.meta.dateAdded|date:'MMM'|uppercase}}</p>
                                </div>
                                <div *ngFor ="let t of tetst; let j = index" class="priscription drug">
                                    <p class="dept">{{t.name}}</p>
                                    <h6 *ngIf="t.report.attachments.length" class="dept previnfo" style="color:lightgrey">
                                    <span><i (click) = "pullImages(i,j, 'test')"data-toggle="modal" data-target="#scanFiles" title="View attachment"  style='font-size: 15px; cursor: pointer;' class="icon ion-android-attach"></i></span>&nbsp;{{t.report.attachments.length + ' '+'attachment'+getLength(t.report.attachments.length)}}
                                    <span style="text-align:right;left:70%;display: inline-block;width:50px"  class="predata priceval">
                                        <i title="Download" style='font-size: 20px;position:absolute;bottom:-17px;left: 75%;cursor: pointer;' class="icon ion-ios-download-outline paid-icon"></i>
                                    </span>
                                    </h6>
                                    <h6 *ngIf="t.report.comment" class="dept previnfo" style="color:lightgrey">
                                    <span><i (click)="toggleComment(i,j,'open') "title="View Comment" style='font-size: 17px;cursor:pointer' class="icon ion-ios-chatbubble-outline"></i></span>
                                    &nbsp;Comment
                                    </h6>
                                    <div *ngIf="t.report.meta.selected"  class="comment">
                                        <div (click) = "toggleComment(i,j,'close')" class="close-comment">
                                            <i title="close" class="icon ion-ios-close-empty"></i>
                                        </div>
                                        <div style="width: 100%; position: relative;height: 80%;" class="comment-note">
                                            <p style="font-size: .75rem;color:gray;padding:0 10px">
                                               {{t.report.comment}}
                                            </p>
                                        </div>
                                        <div class="commentator">
                                            <div class="commentator-media">
                                                <div class=" timeline lastdoc priscriber headerdp small-dp commentor-dp">
                                                        <img style='height:100%; width:100%; object-fit:cover; border-radius:50%;' [src] = getDp(patient.info.personal.avatar)/>
                                                </div>
                                                <p style="font-size: 11px;position: relative;display: inline-block;left:18px;width: 87%;" class="commentator-name">
                                                    Mohammed Abdullahi
                                                        <span style="color:lightgrey;float: right;">
                                                        {{t.report.meta.dateAdded|date:'dd/MM/y hh:mma'|lowercase}}
                                                    </span>
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div style='border-radius:12px;margin-bottom: 4px;' class="card card-secondary maincard halfcard halfcard-right">
                        <div style='border-top-right-radius:12px;border-top-left-radius:12px' class="card-header grapheader">
                            <h1 class="dept headtitle">SCANS</h1>
                        </div>
                        <div style='height:100%;padding-left: 17px;' class="card-body midcardbody">
                            <h1 *ngIf="!patient.record.scans.length" style='color:lightgrey; ' class="dept headtitle record-placeholder">NO RECORD</h1>
                            <div  *ngFor="let scans of patient.record.scans; let i = index"  class="carditem priscriptioncontainer order">
                                <div style='left:-7.2%' class="timeline condition drugtimeline">
                                    <p class="timelinedate"> {{scans[0]?.meta.dateAdded|date:'dd'}}</p>
                                    <p  class="timelinedate month">{{scans[0]?.meta.dateAdded|date:'MMM'|uppercase}}</p>
                                </div>
                                <div *ngFor ="let s of scans; let j= index" class="priscription drug">
                                    <p class="dept">{{s.name}} </p>
                                    <h6 *ngIf="s.report.attachments.length" class="dept previnfo" style="color:lightgrey">
                                    <span><i (click) = "pullImages(i,j, 'scan')" data-toggle="modal" data-target="#scanFiles" title="View attachment"  style='font-size: 15px; cursor: pointer;' class="icon ion-android-attach"></i></span>&nbsp;
                                    {{s.report.attachments.length + ' '+' attachment'+getLength(s.report.attachments.length)}}
                                    <span style="text-align:right;left:70%;display: inline-block;width:50px"  class="predata priceval">
                                        <i title="Download" style='font-size: 20px;position:absolute;bottom:-17px;left: 75%;cursor: pointer;' class="icon ion-ios-download-outline paid-icon"></i>
                                    </span>
                                    </h6>
                                    <h6 *ngIf="s.report.comment" class="dept previnfo" style="color:lightgrey">
                                    <span><i (click)="toggleScanComment(i,j,'open') "title="View Comment" style='font-size: 17px;cursor:pointer' class="icon ion-ios-chatbubble-outline"></i></span>
                                    &nbsp;Comment
                                    </h6>
                                    <div *ngIf="s.report.meta.selected"   style="left:-46px;"  class="comment">
                                        <div (click) = "toggleScanComment(i,j,'close')" class="close-comment">
                                            <i title="close" class="icon ion-ios-close-empty"></i>
                                        </div>
                                        <div style="width: 100%; position: relative;height: 80%;" class="comment-note">
                                            <p style="font-size: .75rem;color:gray;padding:0 10px;z-index: 100;">
                                               {{s.report.comment}}
                                            </p>
                                        </div>
                                        <div class="commentator">
                                            <div class="commentator-media">
                                                <div class=" timeline lastdoc priscriber headerdp small-dp commentor-dp">
                                                        <img style='height:100%; width:100%; object-fit:cover; border-radius:50%;' [src] = getDp(patient.info.personal.avatar)/>
                                                </div>
                                                <p style="font-size: 11px;position: relative;display: inline-block;left:18px;width: 87%;" class="commentator-name">
                                                    Mohammed Abdullahi <span style="color:lightgrey;float: right;">
                                                        {{s.report.meta.dateAdded|date:'dd/MM/y hh:mma'|lowercase}}
                                                    </span>
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card card-secondary historycard midlecard topcard graphcard">
                    <div class="card-header grapheader">
                        <h1 class="dept headtitle">VITALS</h1>
                    </div>
                    <div class="card-body topcardbody nopadding">
                        <h1 *ngIf='!chartData.length' style='color:lightgrey; ' class="dept headtitle record-placeholder">NO RECORD</h1>
                        <div *ngIf='chartData.length' style='padding-left:0%' class="carditem">
                          <!-- <canvas id="bpChart"></canvas> -->
                        </div>
                    </div>
                </div>
                <div class="card-group">
                        <div style='border-radius:12px;margin-bottom: 4px;' class="card card-secondary maincard halfcard">
                            <div style='border-top-right-radius:12px;border-top-left-radius:12px'  class="card-header grapheader">
                                <h1 class="dept headtitle">PROCEDURES</h1>
                            </div>
                            <div style='height:100%;padding-left: 17px;' class="card-body midcardbody">
                                <h1 *ngIf="!patient.record.surgeries.length"  class="dept headtitle record-placeholder">NO RECORD</h1>
                            </div>
                        </div>
                        <div style='border-radius:12px;margin-bottom: 4px;  overflow:hidden' class="card card-secondary maincard halfcard halfcard-right">
                            <div style='border-top-right-radius:12px;border-top-left-radius:12px' class="card-header grapheader">
                                <h1 style="padding-left: 15px;" class="dept headtitle">
                                    <span *ngIf="clientMode ==='edit'"><i  (click)="switchClient('view')" style='position:absolute;right:97%;top:-3px; font-size:large;  cursor:pointer; display: inline-block;color:#1da1f2;' title="Back" class="icon ion-android-arrow-back "> </i>
                                    </span> IMMUNIZATIONS <span *ngIf="clientMode !=='edit'" (click)="switchClient('edit')" style='position:absolute;left:93%;top:-2px; cursor:pointer;'>
                                        <i class="material-icons">short_text</i>
                                    </span>
                                </h1>
                            </div>
                            <div [class.back]='clientMode==="edit"' [class.front]='clientMode==="view"' style='height:100%;padding-left: 17px;position:absolute;width:100%;' class="card-body midcardbody">
                                <h1 *ngIf="!patient.record.immunization.vaccins.length" style='color:lightgrey; ' class="dept headtitle record-placeholder">NO RECORD</h1>
                                <div  *ngFor="let vaccins of patient.record.immunization.vaccins; let i = index"  class="carditem priscriptioncontainer order">
                                    <div style='left:-7.2%' class="timeline condition drugtimeline">
                                        <p class="timelinedate"> {{vaccins[0]?.meta.dateAdded|date:'dd'}}</p>
                                        <p  class="timelinedate month"> {{vaccins[0]?.meta.dateAdded|date:'MMM'|uppercase}}</p>
                                    </div>
                                    <div *ngFor ="let v of vaccins; let j = index" class="priscription drug">
                                        <p class="dept">{{v.name}}</p>
                                    </div>
                                </div>
                            </div>
                            <div [class.in]='clientMode==="edit"' [class.out]='clientMode==="view"'  style='height:100%; padding-left: 7px; padding-right: 7px;padding-top: 4%;position:absolute;' class="card-body standby midcardbody">
                                <div *ngFor="let items of vaccins; let i = index" style="border-left: none; border-bottom: 1px solid whitesmoke;"   class="carditem priscriptioncontainer order">
                                    <div *ngFor="let item of items; let j = index" class="priscription drug">
                                        <p class="dept">{{item.name}} 
                                            <span  class="predata priceval">
                                                <i (click)= "selectVaccin(i, j, 'uncheck')" *ngIf="item.selected" style='color:lightgrey; top:-19px'  class="icon ion-ios-checkmark-empty paid-icon" title="Deselect ">
                                                </i>
                                                <div (click)= "selectVaccin(i, j, 'check')" *ngIf="!item.selected" class="mycheckbox" ></div>
                                            </span>
                                        </p>
                                    </div>
                                </div>
                                <button (click) = 'addImmunizations()' style="width: 105px;font-size: 10px; height:25px;left:28%; bottom:13%;" class="btn btn-sm btn-outline-primary mainbtn">
                                    UPDATE 
                                    <span *ngIf="processing" style="position: absolute; bottom: -7%;left: 4%;"> 
                                        <i class="fa fa-circle-o-notch fa-spin fa-10x slow-spin " 
                                        style="position:absolute;bottom:5px;left:5px;font-size:17px;color: #1da1f2;"> </i>
                                    </span>
                                </button>
                            </div>
                        </div>
                    </div>
            </div>
        </div>
        <div *ngIf='patient._id' class="col col-xs-3 col-sm-3 col-md-3 col-lg-3 col-xl-3">
            <div class="card-colums rightcolumn">

                <div class="card card-secondary historycard rightcard allegies">
                    <div class="card-header grapheader">
                        <h1 class="dept headtitle">FAMILY HISTORY</h1>
                    </div>
                    <div class="card-body rightcardbody">
                        <h1 *ngIf='!patient.record.famHist.length' style='color:lightgrey; width:100%; text-align:center;top:43%;position:absolute;' class="dept headtitle">NO RECORD</h1>
                        <div class="carditem">
                            <ul class="itemlist">
                                <li *ngFor = 'let history of patient.record.famHist'>
                                    {{history.condition}}
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="card card-secondary historycard rightcard medication">
                        <div class="card-header grapheader">
                            <h1 class="dept headtitle">COMPLAINS</h1>
                        </div>
                        <div style ="padding-left:17px;" class="card-body rightcardbody">
                          <div  *ngFor="let comp of patient.record.complains; let i = index"  class="carditem priscriptioncontainer order">
                            <div style='left:-7.2%' class="timeline condition drugtimeline">
                                <p class="timelinedate"> {{comp[0]?.meta.dateAdded|date:'dd'}}</p>
                                <p  class="timelinedate month"> {{comp[0]?.meta.dateAdded|date:'MMM'|uppercase}}</p>
                            </div>
                            <div *ngFor ="let c of comp; let j= index" class="priscription drug">
                                <p class="dept">{{c.complain}}<span class="predata"></span>
                                    <span style='color:lightgrey;font-size:smaller;left:102px;width:27%;position:absolute;text-align:right;'>{{c.duration}}d</span>
                                </p>
                             </div>
                          </div>
                        </div>
                    </div>
                    <div style='max-height:300px' class="card card-secondary historycard rightcard medication">
                            <div class="card-header grapheader">
                                <h1 class="dept headtitle">CONDITIONS</h1>
                            </div>
                            <div style ="padding-left:17px;" class="card-body rightcardbody">
                                    <h1 *ngIf='!patient.record.conditions.length' style='color:lightgrey; width:100%; text-align:center;top:43%;position:absolute;' class="dept headtitle">NO RECORD</h1>
                              <div  *ngFor="let cond of patient.record.conditions; let i = index"  class="carditem priscriptioncontainer order">
                                <div style='left:-7.2%' class="timeline condition drugtimeline">
                                    <p class="timelinedate"> {{cond[0]?.meta.dateAdded|date:'dd'}}</p>
                                    <p  class="timelinedate month"> 
                                        {{cond[0]?.meta.dateAdded|date:'MMM'|uppercase}}
                                    </p>
                                </div>
                                <div *ngFor ="let con of cond; let j= index" class="priscription drug">
                                    <p class="dept">{{con.condition}}<span class="predata"></span>
                                        <!-- <span style='color:lightgrey;font-size:smaller;left:105px;width:27%;position:absolute;text-align:right;'>{{medic[0].meta.dateAdded|date:'hh:mma'|lowercase}}</span> -->
                                    </p>
                                 </div>
                              </div>
                        </div>
                     </div>
                     <div class="card card-secondary historycard rightcard medication">
                        <div class="card-header grapheader">
                            <h1 class="dept headtitle">MEDICATIONS</h1>
                        </div>
                        <div style ="padding-left:17px;" class="card-body rightcardbody">
                                <h1 *ngIf='!patient.record.medications.length' style='color:lightgrey; ' class="dept headtitle record-placeholder">NO RECORD</h1>
                        <div  *ngFor="let medic of patient.record.medications; let i = index"  class="carditem priscriptioncontainer order">
                            <div style='left:-7.2%' class="timeline condition drugtimeline">
                                <p class="timelinedate">{{medic[0]?.meta.dateAdded|date:'dd'}}</p>
                                <p  class="timelinedate month"> {{medic[0]?.meta.dateAdded|date:'MMM'|uppercase}}</p>
                            </div>
                            <div *ngFor ="let m of medic; let j= index" class="priscription drug">
                                <p class="dept">{{m.name}}<span class="predata"></span>
                                    <!-- <span style='color:lightgrey;font-size:smaller;left:105px;width:27%;position:absolute;text-align:right;'>{{medic[0].meta.dateAdded|date:'hh:mma'|lowercase}}</span> -->
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
