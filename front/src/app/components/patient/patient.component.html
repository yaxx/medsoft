<div  class="modal " role="dialog" tabindex="-1" id="addModal" style="border-radius:32px;max-width:841px;margin: auto;padding-top: 35px">
    <div style="max-width: 730px;border-radius:32px;" class="modal-dialog" role="document">
        <div class="modal-content" style="width:100%; height:400px;border-radius:32px;padding-left:0px;padding-right: 0px;">
            <div class="modal-body" style="border-radius:32px;padding: 0px;">
                <div class="card card-secondary historycard midlecard profilecard" style="margin:auto;min-height:400px;border-radius:32px;width:100%;position: absolute">
                    <div style='padding-left: 30px;border-top-right-radius:32px;border-top-left-radius:32px;border-bottom: 0px;height:40px;margin-bottom: 20px;' class="card-header profileheader small-header">
                         <h6 style='font-size:11px;position:absolute;color:dodgerblue; font-weight: normal; top:18px;left:75%' class="patien-name small-name">PATIENT INFO
                        </h6>
                    </div>
                    <div class="card-body orderbody" style="width:85%;margin:auto;">
                        <div class="steps">
                            <div [class.curent-step] = 'count === 0' class="step-item">
                                <span>
                                    <h6 class="step-lebel">PERONAL INFO</h6>
                               </span>
                                <span *ngIf="psn.isValidInfo()">
                                    <i  class="icon ion-ios-checkmark-empty paid-icon"></i>
                               </span>
                            </div>
                            <div [class.curent-step] = 'count === 1' class="step-item">
                                <span>
                                    <h6 class="step-lebel">CONTACT</h6>
                                </span>
                                <span >
                                    <i *ngIf="psn.isValidContact()" class="icon ion-ios-checkmark-empty paid-icon"></i>
                               </span>
                            </div>
                            <div [class.curent-step] = 'count === 2' class="step-item">
                                <span>
                                    <h6 style="width:94px;" class="step-lebel">INSURANCE</h6>
                                </span>
                                <span >
                                    <!-- <i class="icon ion-ios-checkmark-empty paid-icon"></i> -->
                                </span>
                            </div>
                            </div>
                            <form *ngIf="count==0"  style="top: 3%; height:100%;width:60%;position: relative;margin:auto;padding-top: 22px;" class=" staffsform">
                                <div class="form-group vitals-section" style="width:49%; margin-right: 5px; display:inline-block">
                                    <label style="font-size:8px" for="firstname" class="labelss">FIRST NAME<span style='font-size:11px; color:red;'>*</span>
                                    </label>
                                    <input [(ngModel)]="psn.person.info.personal.firstName" style='font-size:11px;text-align: left' autocomplete="off" type="text" name="firstname" class="form-control patientdata dystolic inputs dataInfo">
                                </div>
                                <div style="width:49%; display:inline-block" class="form-group vitals-section">
                                    <label style="font-size:8px" for="lastname" class="labelss">LAST NAME<span style='font-size:11px; color:red;'>*</span> </label>
                                    <input [(ngModel)]="psn.person.info.personal.lastName" style='font-size:11px' autocomplete="off" type="text" name="lastname" class="form-control patientdata dystolic inputs dataInfo"/>
                                </div>
                                <div class="form-group vitals-section" style="width:49%; margin-right: 5px; display:inline-block">
                                    <label style="font-size:8px" for="gender" class="labelss"><span style='font-size:11px; color:red;'>*</span>GENDER</label>
                                    <select name='gender' [(ngModel)]="psn.person.info.personal.gender" style='font-size:11px' autocomplete="off" class="patientdata dystolic inputs dataInfo">
                                        <option>Male</option>
                                        <option>Female</option>
                                    </select>
                                </div>
                                <div style="width:49%; display:inline-block" class="form-group vitals-section">
                                    <label style="font-size:8px" for="status" class="labelss">MARITAL STATUS</label>
                                    <select name='status' [(ngModel)]="psn.person.info.personal.mstatus" style='font-size:11px' autocomplete="off" class="patientdata dystolic inputs dataInfo">
                                        <option>Married</option>
                                        <option>Single</option>
                                    </select>
                                </div>
                                    <div style="width:49%; display:inline-block;margin-right: 5px; " class="form-group vitals-section">
                                        <label style="font-size:8px" for="dob" class="labelss">DATE OF BIRTH<span style='font-size:11px; color:red;'>*</span></label>
                                        <input name='dob' [(ngModel)]="psn.person.info.personal.dob" type="date" style='font-size:11px' autocomplete="off" class="form-control patientdata dystolic inputs dataInfo" />
                                    </div>
                                    <div style="width:49%; display:inline-block; " class="form-group vitals-section">
                                        <label style="font-size:8px" for="tribe" class="labelss">TRIBE</label>
                                        <input name='tribe' [(ngModel)]="psn.person.info.personal.tribe" type="text" style='font-size:11px' autocomplete="off" class=" form-control patientdata dystolic inputs dataInfo" />
                                    </div>
                                    <div class="form-group vitals-section" style="width:49%; margin-right: 5px; display:inline-block">
                                        <label style="font-size:8px" for="religion" class="labelss">RELIGION</label>
                                        <select name='religion' [(ngModel)]="psn.person.info.personal.religion" style='font-size:11px' autocomplete="off" class="patientdata dystolic inputs dataInfo">
                                            <option>Islam</option>
                                            <option>Christianity</option>
                                            <option>Others</option>
                                        </select>
                                    </div>
                                    <div class="form-group vitals-section" style="width:49%; display:inline-block">
                                        <label style="font-size:8px" for="occupation" class="labelss">OCCUPATION</label>
                                        <select name='occupation' [(ngModel)]="psn.person.info.personal.occupation" style='font-size:11px' autocomplete="off" class="patientdata dystolic inputs dataInfo">
                                            <option>Civil Servant</option>
                                            <option>Entreprenure</option>
                                            <option>Farmer</option>
                                            <option>House Wife</option>
                                            <option>Applicant</option>
                                            <option>Student</option>
                                            <option>Others</option>
                                        </select>
                                    </div>
                                    <div style="width:49%; margin-right: 5px; display:inline-block" class="form-group vitals-section">
                                        <label style="font-size:8px" for="cardtype" class="labelss">CARD TYPE<span style='font-size:11px; color:red;'>*</span></label>
                                        <select name='cardtype' [(ngModel)]="psn.card.category" style='font-size:11px' autocomplete="off" class="patientdata dystolic inputs dataInfo">
                                            <option *ngFor="let i of cardTypes">
                                                {{i.item.name}}
                                            </option>
                                        </select>
                                    </div>
                                    <div class="form-group vitals-section" style="width:49%; display:inline-block">
                                        <label style="font-size:8px" for="cardnumber" class="labelss">CARD NUMBER
                                            <span style='font-size:11px; color:red;'>*
                                            </span></label>
                                        <input name='cardnumber' [(ngModel)] = 'psn.card.pin' type="text" style='font-size:11px' autocomplete="off" class="form-control patientdata dystolic inputs dataInfo" />
                                    </div>
                                </form>
                                <form *ngIf="count==1"  style="top: 3%; height:100%;width:60%;position: relative;margin:auto;padding-top: 10px;" class=" staffsform">
                                    <div class="form-group vitals-section" style="width:49%; margin-right: 5px; display:inline-block">
                                        <label style="font-size:8px" for="mobile" class="labelss">MOBILE<span style='font-size:11px; color:red;'>*</span></label>
                                        <input name='mobile' [(ngModel)]="psn.person.info.contact.me.mobile" type="text" style='font-size:11px' autocomplete="off" class="form-control patientdata dystolic inputs dataInfo" />
                                    </div>
                                    <div class="form-group vitals-section" style="width:49%; display:inline-block">
                                        <label style="font-size:8px" for="email" class="labelss">EMAIL</label>
                                        <input name='email' [(ngModel)]="psn.person.info.contact.me.email" type="text" style='font-size:11px' autocomplete="off" class="form-control patientdata dystolic inputs dataInfo" />
                                    </div>
                                    <div class="form-group vitals-section" style="width:49%; margin-right: 5px; display:inline-block">
                                        <label style="font-size:8px" for="statee" class="labelss">STATE</label>
                                        <select name='state' [(ngModel)]="psn.person.info.contact.me.state" style='font-size:11px' autocomplete="off" class=" patientdata dystolic inputs dataInfo">
                                            <option *ngFor='let state of states'>
                                                {{state}}
                                            </option>
                                        </select>
                                    </div>
                                    <div style="width:49%; display:inline-block" class="form-group vitals-section">
                                        <label style="font-size:8px" for="lga" class="labelss">CITY</label>
                                        <select name='lga' [(ngModel)]="psn.person.info.contact.me.lga" style='font-size:11px' autocomplete="off" class="patientdata dystolic inputs dataInfo">
                                            <option *ngFor='let lga of psn.getLgas()'>
                                                {{lga}}
                                            </option>
                                        </select>
                                    </div>
                                    <div class="form-group vitals-section address">
                                        <label style="font-size:8px" for="address" class="labelss">ADDRESS</label>
                                        <input [(ngModel)]="psn.person.info.contact.me.address" style='font-size:11px' autocomplete="off" type="text" name="address" class="form-control patientdata dystolic inputs dataInfo" />
                                    </div>
                                    <div class="form-group vitals-section" style="width:49%; margin-right: 5px; display:inline-block">
                                        <label style="font-size:8px" for="statee" class="labelss"><span style='font-size:11px; color:red;'>*</span>NEXT OF KIN NAME</label>
                                        <input name='kinname' [(ngModel)]="psn.person.info.contact.me.kinName" type="text" style='font-size:11px' autocomplete="off" class="form-control patientdata dystolic inputs dataInfo" />
                                    </div>
                                    <div style="width:49%; display:inline-block" class="form-group vitals-section">
                                        <label style="font-size:8px" for="lga" class="labelss">NEXT OF KIN MOBILE</label>
                                        <input name='kinmobile' [(ngModel)]="psn.person.info.contact.me.kinMobile"type="text" style='font-size:11px' autocomplete="off" class="form-control patientdata dystolic inputs dataInfo" />
                                    </div>
                                    <div class="form-group vitals-section" style="width:49%; margin-right: 5px; display:inline-block">
                                        <label style="font-size:8px" for="ename" class="labelss">EMERGENCY CONTACT NAME</label>
                                        <input name='ename' [(ngModel)]="psn.person.info.contact.emergency.name" type="text" style='font-size:11px' autocomplete="off" class="form-control patientdata dystolic inputs dataInfo" />
                                    </div>
                                    <div class="form-group vitals-section" style="width:49%; display:inline-block">
                                        <label style="font-size:8px" for="emobile" class="labelss"><span style='font-size:11px; color:red;'>*</span>EMERGENCY MOBILE</label>
                                        <input name='emobile' [(ngModel)]="psn.person.info.contact.emergency.mobile" type="text" style='font-size:11px' autocomplete="off" class="form-control patientdata dystolic inputs dataInfo" />
                                    </div>
                                    <div class="form-group vitals-section" style="width:49%; margin-right: 5px; display:inline-block">
                                        <label style="font-size:8px" for="eoccp" class="labelss">RELATIONSHIP</label>
                                        <select name='rel' [(ngModel)]="psn.person.info.contact.emergency.rel" style='font-size:11px' autocomplete="off" class="patientdata dystolic inputs dataInfo">
                                            <option>Parent</option>
                                            <option>Spouse</option>
                                            <option>Sibling</option>
                                            <option>Other</option>
                                        </select>
                                    </div>
                                    <div style="width:49%; display:inline-block" class="form-group vitals-section">
                                        <label style="font-size:8px" for="rel" class="labelss">OCCUPATION</label>
                                        <select name='occupation' [(ngModel)]="psn.person.info.contact.emergency.occupation" style='font-size:11px' autocomplete="off" class="patientdata dystolic inputs dataInfo">
                                            <option>Civil Servant</option>
                                            <option>Entreprenure</option>
                                            <option>Farmer</option>
                                            <option>House Wife</option>
                                            <option>Applicant</option>
                                            <option>Student</option>
                                            <option>Others</option>
                                        </select>
                                    </div>
                                </form>
                                <form *ngIf="count==2"  style="top: 3%; height:100%;width:60%;position: relative;margin:auto;padding-top:26px;" class=" staffsform">
                                <div class="form-group vitals-section" style="width:49%; margin-right: 5px; display:inline-block">
                                    <label style="font-size:8px" for="ename" class="labelss">GROUP No.</label>
                                    <input name='ename' type="text" style='font-size:11px' autocomplete="off" class="form-control patientdata dystolic inputs dataInfo" />
                                </div>
                                <div class="form-group vitals-section" style="width:49%; display:inline-block">
                                    <label style="font-size:8px" for="emobile" class="labelss">ID No.</label>
                                    <input name='emobile' type="text" style='font-size:11px' autocomplete="off" class="form-control patientdata dystolic inputs dataInfo" />
                                </div>
                                <div class="form-group vitals-section" style="width:49%; margin-right: 5px; display:inline-block">
                                    <label style="font-size:8px" for="eoccp" class="labelss">SUBSCRIBER</label>
                                    <input name='emobile'  type="text" style='font-size:11px' autocomplete="off" class="form-control patientdata dystolic inputs dataInfo" />
                                </div>
                                <div style="width:49%; display:inline-block" class="form-group vitals-section">
                                    <label style="font-size:8px" for="rel" class="labelss">EMPLOYER</label>
                                    <input name='emobile'  type="text" style='font-size:11px' autocomplete="off" class="form-control patientdata dystolic inputs dataInfo" />
                                </div>
                                <div class="form-group vitals-section" style="width:49%; margin-right: 5px; display:inline-block">
                                    <label style="font-size:8px" for="eoccp" class="labelss">SSN</label>
                                    <input name='emobile'  type="text" style='font-size:11px' autocomplete="off" class="form-control patientdata dystolic inputs dataInfo" />
                                </div>
                                <div style="width:49%; display:inline-block" class="form-group vitals-section">
                                    <label style="font-size:8px" for="rel" class="labelss">RELATIONSHIP</label>
                                    <select name='rel' style='font-size:11px' autocomplete="off" class="patientdata dystolic inputs dataInfo">
                                        <option>Parent</option>
                                        <option>Spouse</option>
                                        <option>Self</option>
                                        <option>Sibling</option>
                                        <option>Other</option>
                                    </select>
                                </div>
                            </form>
                        </div>
                    </div>
                    <div style="left:12%; top:45%;position: absolute;
                    width: 7%;" class="btn-group disposition">
                        <button [disabled]='count === 0' (click) = prev() style="width:32px;height: 32px;border-radius: 50%;left:35%"   class="btn btn-outline-primary  dispo shift-button" >
                            <i style='position:absolute;right:36%;top:2px; font-size:large; cursor:pointer; display: inline-block;' title="Back" class="icon ion-android-arrow-back "> 
                            </i>
                        </button>
                    </div>
                    <div style="left: 76%; top:45%;position: absolute;
                    width: 7%;" class="btn-group disposition">
                        <button [disabled]='count === 2'(click)=next() style="width:32px;height: 32px;border-radius: 50%;left:35%"   class="btn btn-outline-primary  dispo .shift-button">
                            <i style='position:absolute;right:36%;top:2px; font-size:large; cursor:pointer; display: inline-block;' title="Next" class="icon ion-android-arrow-forward "> 
                            </i>
                        </button>
                    </div>
                    
                    <div *ngIf="count === 2 " style="left:31%;top:286px;position:relative;width:53%" class="btn-group disposition">
                        <button (click) = updateInfo() [disabled] = "psn.updating||psn.isInvalidForm()"  style=" width: 170px;font-size: 10px; border-radius: 30px; height:27px;left:15%; bottom:10%;" class="btn btn-sm btn-outline-primary  mainbtn">
                            UPDATE INFORMATION
                            <span *ngIf='psn.updating' style="position: absolute; bottom: -7%;left: 10%;">
                                <i class="fa fa-circle-o-notch fa-spin fa-10x slow-spin " style="position:absolute;bottom:5px;left:5px;font-size:19px;color: #1da1f2;"></i>
                            </span>
                        </button>
                    </div>
                    <h6 *ngIf="psn.successMsg" class="feedbackMsg">{{psn.successMsg}}</h6>
                    <h6 *ngIf="psn.errorMsg"  style="color: red" class="feedbackMsg">
                        {{psn.errorMsg}}
                    </h6>
                </div>
            </div>
        </div>
    </div>

    <div  class="modal " role="dialog" tabindex="-1" id="medicModal" style="border-radius:32px;max-width:841px;margin: auto;padding-top: 35px">
            <div style="max-width: 730px;border-radius:32px;" class="modal-dialog" role="document">
                <div class="modal-content" style="width:100%; height:400px;border-radius:32px;padding-left:0px;padding-right: 0px;">
                    <div class="modal-body" style="border-radius:32px;padding: 0px;">
                        <div class="card card-secondary historycard midlecard profilecard" style="margin:auto;min-height:400px;border-radius:32px;width:100%;position: absolute">
                            <div  data-dismiss="modal" style="height: 25px; width:25px; top:3%; cursor: pointer;  color: white(248, 248, 248); background:rgba(193, 193, 224, 0.2)" class="close-comment">
                                <i  title="close" class="icon ion-ios-close-empty"></i>
                            </div>
                            <div style='padding-left: 30px;border-top-right-radius:32px;border-top-left-radius:32px;border-bottom: 0px;height:40px;margin-bottom: 15px;' class="card-header profileheader small-header">
                                <div style="left:23px;top:13px" class="timeline lastdoc priscriber headerdp small-dp">
                                    <img [src]=getDp(patients[curIndex].info.personal.avatar)/>
                                </div>
                                <p style="top:5px"  href="#" class="patien-name small-name">
                                {{patients[curIndex]?.info.personal.firstName + ' ' + patients[curIndex].info.personal.lastName}}<span class="small-headericon"></span>
                                </p>
                                <h6 style='font-size:11px; font-weight:bold; position:absolute;color:dodgerblue;top:5%;left:70%' class="patien-name small-name">MEDICATIONS</h6>
                            </div>
                        <div *ngIf='cardView.orders'  class="card-body orderbody" style=" width:55%; margin:auto; ">
                            <div style="border-left:2px solid #1da1f2;height:290px; width:100%;">
                                <div style='border:none' *ngFor="let medic of patient.record.medications; let i = index" class="carditem priscriptioncontainer order">
                                    <div style='left:-3%' class="timeline condition drugtimeline">
                                        <p class="timelinedate">{{medic[0]?.meta.dateAdded|date:'dd'}}</p>
                                        <p class="timelinedate month"> {{medic[0]?.meta.dateAdded|date:'MMM'|uppercase}}</p>
                                    </div>
                                    <div *ngFor="let m of medic; let j = index" class="priscription drug">
                                        <h6 [ngStyle]=getStyle(m) class="dept">{{m.name}}&nbsp;<span class="predata">
                                        </span>
                                            <span  class="predata priceval">
                                            <i (click)="selectMedication(i,j)" style=' color:lightgrey;'  *ngIf="m.meta.selected" class="icon ion-ios-checkmark-empty paid-icon" title="Deselect ">
                                            </i>
                                            <!-- <div  style='border-color:rgb(216, 216, 216)' *ngIf ="!m.price" class="mycheckbox"></div> -->
                                            <div  class="mycheckbox" *ngIf="(!m.meta.selected) "  (click)="selectMedication(i,j)" >
                                            </div>
                                            </span>
                                        </h6>
                                        <h6 class="dept previnfo">Dosage&nbsp;
                                            <span class="predata">
                                                {{m.priscription.intake+'-'+m.priscription.freq+'-'+m.priscription.piriod}}
                                            </span>
                                        </h6>
                                        <h6 class="dept previnfo">
                                            <span class="predata">{{m.meta.dateAdded | date:'hh:mma'|lowercase}}</span>
                                            <span *ngIf="m.lastTaken" style="color:lightgrey;font-size:10px;left:77%;text-align:right;position: absolute;width: 82px" class="predata">{{m.lastTaken | date:'dd MMM hh:mma'|uppercase}}</span>
                                            <span *ngIf="!m.lastTaken"  style="color:lightgrey;font-size:10px;left:74.5%;text-align:right;position: absolute;width: 82px" class="predata">---</span>
                                        </h6>
                                   </div>
                                    <!-- <label class='totalLbl' *ngIf='somePaid(i)'>{{getTransTotal(medic)}} </label> -->
                                </div>
                            </div>
                        </div>
                        <div *ngIf='cardView.editing' class="card-body orderbody" style="width:55%;margin:auto;">
                                <form style="top:15%;" class=" staffsform">
                                    <div style="top:1px; margin-bottom:25px; min-height: 80px;max-height: 120;" class="form-group vitals-section setGroup">
                                        <table *ngIf="selections.length" cellspacing="0" class="data-table drugs-table" style="width:100%;left:0%;">
                                            <thead class='productHead'>
                                                <tr style="padding-left: 4px" class="staff-th">
                                                    <th style="padding:3px 8px;font-weight: bold;color:#1da1f2;" class="headlbl staff-th">MEDICATION</th>
                                                    <th style='text-align:right;padding:3px 8px;font-weight: bold;color:#1da1f2;' class="headlbl staff-th">DOSAGE</th>
                                                    <th style='text-align:right;padding:3px 8px;font-weight: bold;color:#1da1f2;' class="headlbl staff-th">LAST ADMINISTERED</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr *ngFor="let m of selections; let i = index; let odd = odd;" style="border-bottom:2px solid white;" [class.even]=odd class="ro staff-row">
                                                    <td [ngStyle]=getStyle(m)  style="padding:2px 4px; " class="data">
                                                        {{m.name}}
                                                    </td>
                                                    <td style='font-size:11px;text-align:right;padding:2px 6px;' class="data">
                                                    {{m.priscription.intake+'-'+m.priscription.freq+'-'+m.priscription.piriod}}
                                                    </td>
                                                    <td style='font-size:11px;text-align:right;padding:2px 6px;' class="data">
                                                   02-05-2019 05:45PM
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <button (click) = changeMedStatus() style=" width: 170px;font-size: 10px; height:27px;left:28%; bottom:24%;" class="btn btn-sm btn-outline-primary mainbtn">CHANGE STATUS
                                        <span style="position: absolute; bottom: -7%;left: 80%;">
                                        <i *ngIf="processing" class="fa fa-circle-o-notch fa-spin fa-10x slow-spin " style="position:absolute;bottom:5px;left:5px;font-size:19px;color: #1da1f2;"> </i>
                                        </span>
                                    </button>
                                </form>
                            </div>
                            <div *ngIf='cardView.editing' style="left:7%; top:45%;position: absolute;
                                width: 7%;" class="btn-group disposition">
                                <button (click)="switchViews('orders')" style="width:32px;height: 32px;border-radius: 50%;left:35%"   class="btn btn-outline-primary  dispo shift-button" >
                                    <i  style='position:absolute;right:36%;top:2px; font-size:large; cursor:pointer; display: inline-block;' title="Back" class="icon ion-android-arrow-back"> 
                                    </i>
                                </button>
                            </div>
                            <div *ngIf='cardView.orders && medSelected()' style="left:80%; top:45%;position: absolute;
                            width: 7%;" class="btn-group disposition">
                                <button (click)=switchToEdit() style="width:32px;height: 32px;border-radius: 50%;left:35%"   class="btn btn-outline-primary  dispo shift-button" >
                                    <i   style='position:absolute;right:36%;top:2px; font-size:large; cursor:pointer; display: inline-block;' title="Go to payment" class="icon ion-android-arrow-forward "> 
                                    </i>
                                </button>
                            </div>
                            <h6 *ngIf="successMsg" class="feedbackMsg">{{successMsg}}</h6>
                            <h6 *ngIf="errorMsg"  style="color: red" class="feedbackMsg">{{errorMsg}}</h6>
                        </div>
                    </div>
                </div>
            </div>
        </div>

<nav class="navbar fixed-top navbar-light navbar-expand-md navigation-clean-search" style="padding:0px; margin-bottom:0px">
    <div class="container">
        <a class="navbar-brand" href="#">
            <em>synaptix</em>
        </a>        
        <div class="collapse navbar-collapse" id="navcol-1">
            <form class="top-searchform" target="_self">
                <div class="form-group">
                  <input [(ngModel)] = searchTerm #search (keyup)='searchPatient(searchTerm)' autocomplete = "off" style="border-radius:.999em;  width:80%;display:inline-block; position: absolute; text-align: left;
                 vertical-align: middle; top:11%; background-color: rgba(233, 236, 239, 0.7);box-shadow:none;  outline:none;
                  "
                  class="form-control"
                  type="search" name="search" id="search-field" placeholder="Search patient">
                  <i style='font-size:20px; top:3px;left:83%;position:relative;display:inline' class="icon ion-ios-search " title="Search"></i>
                  <h6 style='font-size:12px;
                        left:98%;position:relative;display:inline-block;color:grey;
                        font-weight:normal;'>Sort: <span style='cursor:pointer; color:#1da1f2;'  (click)='toggleSortMenu()'>
                          {{nowSorting}}</span>
                  </h6>
                  <div *ngIf=sortMenu style='position: absolute;
                        left:120%;
                        width:100px;top:6px;
                        height:110px'  class="menu">
              <ul (mouseleave) = 'toggleSortMenu()' class="actions primary">
                  <li (click)='sortPatients("name")' class="action">A-Z</li>
                  <li (click)='sortPatients("age")' class="action">Age</li>
                  <li (click)='sortPatients("status")' class="action">Status</li>
                  <li (click)='sortPatients("sex")' class="action">Gender</li>
                  <li (click)='sortPatients("date")' class="action">Date added</li>
              </ul>
            </div>
        </div>          
      </form>
    </div>
    </div>

    <div (mouseleave) = hideLogOut() class="timeline lastdoc priscriber headerdp small-dp user-dp" style="left:90%;position:absolute;height:87px;width:90px;top:5px; margin-bottom:0px;background:inherit">
        <div  class="timeline lastdoc priscriber headerdp small-dp user-dp" style="position:absolute;height:30px;width:30px;top:5px; margin-bottom:0px;"> 
            <img (click) = showLogOut() style='height:100%; width:100%; object-fit:cover; cursor: pointer;' [src]=getMyDp()/>
            <span *ngIf="logout">
                <div style='position: absolute;width: 100px;top: 33px;height: 34px; padding-left: 0px;left: -95%;' class="menu">
                    <ul  class="actions primary">
                        <li style="text-align: center;padding-left: 0px;" (click)=logOut() class="action">
                            Log out
                        </li>
                    </ul>
                </div>
            </span>
        </div>
    </div>
</nav>

    <div style="padding-top:60px" class="container">
        <div class="row">
        <div *ngIf='!patients.length' class='issue'>
            <div *ngIf='loading' class="lds-css ng-scope">
            <div style="width:100%;height:100%" class="lds-rolling"><div></div></div></div>
            <div (click)=refresh()  *ngIf='message' title='Refresh' class='refresh'><i class="icon ion-ios-reload "></i></div>
             <h6 *ngIf='message' style='font-size:13px;position:absolute;top:65%; width:100%; color:lightgrey;text-align: center' >{{message}}</h6>
         </div>
         <div *ngFor="let patient of patients; let i = index" class="col-xl-4 col-lg-4 col-md-4 col-sm-6 col-xs-12">
                <div  style="overflow: hidden;" class="card card-secondary maincard " >
                    <div *ngIf="patient.card.view==='front'"  style='padding-left: 30px; border-top-right-radius: 12px; border-top-left-radius: 12px;  padding-top: 0px;
                    height: 32px;
                    padding-bottom: 0px;' class="card-header profileheader">
                    <i *ngIf="isConsult()" (click)='showMenu(i)' class="icon ion-android-more-vertical headericon moreicon actions-icon"></i>
                        <div style="left: 62%" (mouseleave) = hideMenu(i) *ngIf="patient.card.menu" class="menu">
                            <ul  class="actions primary">
                                <li (click)="switchCards(i,'dispose')" class="action">Disposition</li>
                                <!-- <li (click)="switchCards(i,'ap')" class="action">Set Appointment</li> -->
                                <li (click)="selectPatient(i)" data-target="#medicModal" data-toggle="modal" class="action">Medications</li>
                            </ul>
                        </div>
                    </div>
                    <div *ngIf="patient.card.view ==='dispose'|| patient.card.view === 'ap'" style='padding-left: 37px;   border-top-right-radius: 12px; border-top-left-radius: 12px; padding-top: 0px;
                    position:absolute;  width:100%;padding-bottom: 0px;height:32px' class="card-header profileheader small-header">
                        <i (click)="switchCards(i,'front')" style='position:absolute;
                              left:3%;top:4px; cursor:pointer;
                              display: inline-block;
                              color:#1da1f2;' title="Back" class="icon ion-android-arrow-back ">
                            </i>
                        <div style="left:23px;position: absolute;" class="timeline lastdoc priscriber headerdp small-dp">
                            <img [src]=getDp(patient.info.personal.avatar)/>
                        </div>
                        <p style="top:6px;margin-bottom:0px;position: absolute;" class="patien-name small-name">
                            {{patient.info.personal.firstName + ' '+ patient.info.personal.lastName}}<span class="small-headericon"></span>
                        </p>
                    </div>
                    
                    <div [class.ap]='cardCount' [class.front]='patient.card.view==="front"' style="position: absolute; width:100%;height: 87%;top:13%" class="card-body mainbody">
                        <div style="position: relative;margin-bottom: 0px;top:0px" class="timeline lastdoc priscriber headerdp">
                        <img (click)='showDetails(i)' [src]=getDp(patient.info.personal.avatar)/>
                        </div>
                        <p *ngIf="isInfo()" (click)=viewDetails(i) data-toggle="modal" data-target="#addModal" title="View Details" style='margin-bottom:2px;position:relative;top:3px' class="patien-name display-name">
                            {{patient.info.personal.firstName + ' '+patient.info.personal.lastName}}
                        </p>
                       
                        <a style="position:relative;top:3px" *ngIf='isConsult()' href="#" title="View history" [routerLink]="['../history', patient._id]" routerLinkActive="router-link-active" class="patien-name">
                        {{patient.info.personal.firstName + ' ' + patient.info.personal.lastName}}
                        <span class="predata editicon"></span></a>
                        <a style="position:relative;top:3px" *ngIf='isAdmin()' href="#" title="View history" [routerLink]="['../history', patient._id]" routerLinkActive="router-link-active" class="patien-name">
                        {{patient.info.personal.firstName + ' ' + patient.info.personal.lastName}}
                        <span class="predata editicon"></span></a>
                        <div>
                            <div style="position: relative;top:12px" class="carditem basic-item">
                                <h6 class="dept basic-info">Sex</h6>
                                <h6 class="dept basic-info sex-info">
                                    {{patient.info.personal.gender.charAt(0).toUpperCase()}}
                                </h6>
                            </div>
                            <div style="position: relative;top:12px" class="carditem basic-item">
                                <h6 class="dept basic-info">Age</h6>
                                <h6 class="dept basic-info sex-info">{{patient.info.personal.dob|dob}}</h6>
                            </div>
                            <div style="position: relative;top:12px" class="carditem basic-item">
                                <h6 class="dept basic-info">Room</h6>
                                <h6 class="dept basic-info sex-info"> {{patient.record.visits[0][0].wardNo ||'?'}}</h6>
                            </div>
      
                        </div>
                        <h6 *ngIf='isAdmin()||isInfo()' style="width:100%;position:relative;text-align:center" class="dept basic-secondary basic-value">
                            {{patient.record.visits[0][0].dept}}
                        </h6>
                        <h6 style="width:100%; bottom:5px;position:relative;text-align:center;" class="dept basic-secondary basic-value">
                            {{patient.record.visits[0][0].visitedOn|date:'dd-MM-y'}}&nbsp;<span>
                            {{patient.record.visits[0][0].visitedOn | date:'hh:mma'|lowercase}}</span>
                        </h6>
                       
                    </div>
    
                    <div [class.on]='patient.card.view === "dispose"'  style="position:absolute; width:100%;height: 87%;top:13%;background:white;border-bottom-right-radius: 12px;border-bottom-left-radius: 12px;margin-left:0px;border:none;padding-top: 0px;" class="card-body off">
                        <div class="btn-group disposition">
                            <button style="width:112px;" (click)="dispose(i,'out', 'discharge')" [class.active] ='patient.record.visits[0][0].status==="out"' class="btn btn-outline-primary  dispo " >Discharge</button>
                            <button 
                            style="border-radius: 30px; width:112px;border-top-left-radius: 0px; border-bottom-left-radius: 0px;"
                             (click)="dispose(i, 'queued', 'foward')"  [class.active] ='patient.record.visits[0][0].status==="queued"' class="btn btn-outline-primary  dispo">Foward
                            </button>
                        </div>
                        <form [class.in] ='patient.record.visits[0][0].status==="queued"' [class.out] ='patient.record.visits[0][0].status!=="queued"' style="top:35%;position:absolute;width:100%; padding-left: 4%; padding-right: 6%;" class=" staffsform next-dept">
                            <div style=" margin-top:2px;   " class="form-group vitals-section formGroup">
                                <label style='font-size:8px;left: 25px;top:-15%;' for="title" class="labelss complain">DEPARTMENT</label>
                                <select  [(ngModel)]="patient.record.visits[0][0].dept" style='font-size:11px; width:100%; padding-left: 5px;'  name="pulse" class="patientdata  dataInfo ref-dept" >
                                    <option *ngFor="let item of getRefDept()">{{item.name}}</option>
                                </select>
                            </div>
                        </form>
                        <button [disabled] = processing (click)='comfirmDesposition(i)'  style=" width: 170px;font-size: 10px; height:27px;left:15%; bottom:17%;" class="btn btn-sm btn-outline-primary  mainbtn">
                            {{patient.card.btn|uppercase}} PATIENT
                            <span style="position: absolute; bottom: -7%;left: 80%;">
                            <i *ngIf="processing" class="fa fa-circle-o-notch fa-spin fa-10x slow-spin " style="position:absolute;bottom:5px;left:5px;font-size:19px;color: #1da1f2;"> </i>
                        </span>
                        </button>
                    </div> 
    
    
                  
                    <!-- <div [class.on]='patient.card.view==="ap"' style="position: absolute; width:100%;height: 87%;top:22%;background:white;border-bottom-right-radius: 12px;
                    border-bottom-left-radius: 12px; margin-left:0px;border:none;padding-top: 0px;" class="card-body off">
                        <form style="top:15%;  width:85%;margin: auto;" class=" staffsform">
                            <div style=" margin-top:3px;" class="form-group vitals-section formGroup">
                                <label style='font-size:8px' for="title" class="labelss complain">TITLE</label>
                                <input [(ngModel)]="session.appointment.title" style='font-size:11px' type="text" name="aptitle" class="patientdata inputs dataInfo" placeholder="E.g Anti Natal Routine">
                            </div>
                            <div class="form-group vitals-section formGroup">
                                <label style='font-size:8px' for="date" class="labelss complain">DATE</label>
                                <input [(ngModel)]="session.appointment.date" style='font-size:11px' type="date" name="date" class="patientdata inputs dataInfo">
                            </div>
                            <div class="form-group vitals-section formGroup">
                                <label style='font-size:8px' for="time" class="labelss complain">TIME</label>
                                <input [(ngModel)]="session.appointment.time" style='font-size:11px' type="time" name="time" class="patientdata inputs dataInfo">
                            </div>
                        </form>
                        <button (click)='setAppointment()' *ngIf="isConsult" style=" width: 170px;font-size: 10px; height:27px;left:15%; bottom:27%;" class="btn btn-sm btn-outline-primary mainbtn">
                            SET APPOINTMENT 
                            <span *ngIf="processing" style=" position: absolute; bottom: -7%;left: 80%;"> 
                                <i class="fa fa-circle-o-notch fa-spin fa-10x slow-spin " style="position:absolute;bottom:5px;left:5px;font-size:19px;color: #1da1f2;"> </i>
                            </span>
                        </button>
                    </div> -->
                    <h6 *ngIf="successMsg && curIndex===i" class="feedbackMsg">{{successMsg}}</h6>
                    <h6 *ngIf="errorMsg && curIndex===i"  style="color: red" class="feedbackMsg">{{errorMsg}}</h6>
            </div>
        </div>
    </div>
</div>
